<h1>Course List</h1>

<div class="center">
<%= form_tag courses_path, :method => 'get' do %>
    <p>
      <%= text_field_tag :query, params[:query] %>
      <%= submit_tag 'Search', :course_number => nil %>
    </p>
<% end %>
</div>

<table class="table">
  <thead>
    <tr>
      <th>Course Number</th>
      <th>Title</th>
      <th>Description</th>
      <th>Start Date</th>
      <th>End Date</th>
      <th>Status</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @courses.each do |course| %>
      <tr>
        <td><%=course.course_number%></td>
        <td><%=course.title%></td>
        <td><%=course.description%></td>
        <td><%=course.start_date%></td>
        <td><%=course.end_date%></td>
        <td><%=course.status%></td>
        <td><%= link_to 'Show', course %></td>
        <% if current_user.is_admin? || current_user.is_instructor? %>
            <td><%= link_to 'Edit', edit_course_path(course) %></td>
        <% end %>
         <% if current_user.is_admin? %>
             <td><%= link_to 'Destroy', course, method: :delete, data: { confirm: 'Are you sure?' } %></td>
         <% end %>
        <% if current_user.is_student? %>
          <td>
            <%= form_for(@enrollment) do |f| %>
                <%= f.hidden_field :course_id, :value => course.id %>
                <%= f.hidden_field :user_id, :value => current_user.id %>
                <%= f.hidden_field :approve, :value => false %>
                <%= f.hidden_field :deny, :value => false %>
                <div class="actions">
                  <%= f.submit :Enroll %>
                </div>
            <%end%>
          </td>
        <%end%>
      </tr>
    <% end %>
  </tbody>
</table>